<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Inventario de Activos</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #1a237e; padding: 6px 8px; }
        th { background: #1a237e; color: #fff; }
        input, textarea { width: 98%; box-sizing: border-box; }
    </style>
</head>
<body>
    <h2>Inventario de Activos Seleccionados</h2>
    <form id="inventoryForm">
        <table>
            <thead>
                <tr>
                    <th>Sistema</th>
                    <th>Descripción</th>
                    <th>Clasificación</th>
                    <th>Propietario</th>
                    <th>Autorizador</th>
                    <th>Estado</th>
                    <th>Comentarios internos</th>
                </tr>
            </thead>
            <tbody id="inventoryTableBody">
                <!-- Aquí se cargan los activos seleccionados -->
            </tbody>
        </table>
        <button type="submit">Guardar Cambios</button>
    </form>

    <!-- Modal -->
    <div id="modalClasificacion" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:30px; border-radius:8px; max-width:350px; margin:auto; text-align:center;">
            <h3>¿Cómo deseas clasificar los activos?</h3>
            <button id="btnDirecto" style="margin:10px; padding:10px 20px;">Directo</button>
            <button id="btnCuestionario" style="margin:10px; padding:10px 20px;">Cuestionario</button>
        </div>
    </div>

    <script>
        // Campos por defecto para los activos del JSON
        const campos = [
            "sistema",
            "descripcion",
            "clasificacion",
            "propietario",
            "autorizador",
            "estado",
            "comentarios"
        ];

        // Mapeo de nombres amigables
        const nombres = {
            sistema: "Sistema",
            descripcion: "Descripción",
            clasificacion: "Clasificación",
            propietario: "Propietario",
            autorizador: "Autorizador",
            estado: "Estado",
            comentarios: "Comentarios internos"
        };

        // Cargar activos seleccionados
        const activos = JSON.parse(localStorage.getItem('activosSeleccionados') || "[]");
        const tbody = document.getElementById('inventoryTableBody');

        activos.forEach((item, idx) => {
            const tr = document.createElement('tr');
            // Si es manual, solo tiene sistema y descripcion
            tr.innerHTML = `
                <td><input name="sistema" value="${item.sistema || ''}"></td>
                <td><input name="descripcion" value="${item.descripcion || ''}"></td>
                <td><input name="clasificacion" value="${item.clasificacion || ''}"></td>
                <td><input name="propietario" value="${item.propietario || ''}"></td>
                <td><input name="autorizador" value="${item.autorizador || ''}"></td>
                <td><input name="estado" value="${item.estado || ''}"></td>
                <td><input name="comentarios" value="${item.comentarios || ''}"></td>
            `;
            tbody.appendChild(tr);
        });

        // Guardar cambios (puedes personalizar la acción)
        document.getElementById('inventoryForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // Recolectar datos editados
            const filas = document.querySelectorAll('#inventoryTableBody tr');
            const inventarioEditado = [];
            filas.forEach(tr => {
                const inputs = tr.querySelectorAll('input');
                inventarioEditado.push({
                    sistema: inputs[0].value,
                    descripcion: inputs[1].value,
                    clasificacion: inputs[2].value,
                    propietario: inputs[3].value,
                    autorizador: inputs[4].value,
                    estado: inputs[5].value,
                    comentarios: inputs[6].value
                });
            });

            // Guardar el inventario editado en localStorage
            localStorage.setItem('inventarioEditado', JSON.stringify(inventarioEditado));

            // Mostrar el modal
            document.getElementById('modalClasificacion').style.display = 'flex';
        });

        // Botón para clasificación directa
        document.getElementById('btnDirecto').onclick = function() {
            window.location.href = '../assetsNumber/assets_numbers.html';
        };

        // Botón para clasificación con cuestionario
        document.getElementById('btnCuestionario').onclick = function() {
            window.location.href = '../assetsQuestions/assets_form.html';
        };
    </script>
</body>
</html>